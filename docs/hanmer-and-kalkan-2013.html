<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.6 Hanmer and Kalkan (2013) | Statistical Modeling: A Tools Approach</title>
  <meta name="description" content="Lecture notes covering the key tools of regression modeling in political science." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="6.6 Hanmer and Kalkan (2013) | Statistical Modeling: A Tools Approach" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Lecture notes covering the key tools of regression modeling in political science." />
  <meta name="github-repo" content="pos5747/adv-methods-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.6 Hanmer and Kalkan (2013) | Statistical Modeling: A Tools Approach" />
  
  <meta name="twitter:description" content="Lecture notes covering the key tools of regression modeling in political science." />
  

<meta name="author" content="Carlisle Rainey" />


<meta name="date" content="2022-10-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rainey-2016.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<script>
    $(document).ready(function () {
        process_solutions();
    });
    function process_solutions() {
        $("div.section[id^='solution']").each(function(i) {
        var soln_wrapper_id = "cvxr_ex_" + i;
        var solution_id = $(this).attr('id');
        var button = $("<button onclick=\"toggle_solution('" + soln_wrapper_id + "')\">Show/Hide</button>");
        var new_div = $("<div id='" + soln_wrapper_id + "' class='solution' style='display: none;'></div>");
        var h = $(this).first();
        var others = $(this).children().slice(1);
        $(others).each(function() {
            $(this).appendTo($(new_div));
        });
        $(button).insertAfter($(h));
        $(new_div).insertAfter($(button));
        })
    }
    function toggle_solution(el_id) {
      $("#" + el_id).toggle();
    } 
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Methods Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Week 1: Maximum Likelihood<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="class-agenda.html"><a href="class-agenda.html"><i class="fa fa-check"></i><b>1.1</b> Class agenda<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i><b>1.2</b> Maximum Likelihood<span></span></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-bernoulli-distribution"><i class="fa fa-check"></i><b>1.2.1</b> Example: Bernoulli Distribution<span></span></a></li>
<li class="chapter" data-level="1.2.2" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-poisson-distribution"><i class="fa fa-check"></i><b>1.2.2</b> Example: Poisson Distribution<span></span></a></li>
<li class="chapter" data-level="1.2.3" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#remarks"><i class="fa fa-check"></i><b>1.2.3</b> Remarks<span></span></a></li>
<li class="chapter" data-level="1.2.4" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-beta-distribution"><i class="fa fa-check"></i><b>1.2.4</b> Example: Beta Distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="the-invariance-property.html"><a href="the-invariance-property.html"><i class="fa fa-check"></i><b>1.3</b> The Invariance Property<span></span></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="the-invariance-property.html"><a href="the-invariance-property.html#example-bernoulli-odds"><i class="fa fa-check"></i><b>1.3.1</b> Example: Bernoulli Odds<span></span></a></li>
<li class="chapter" data-level="1.3.2" data-path="the-invariance-property.html"><a href="the-invariance-property.html#example-poisson-sd"><i class="fa fa-check"></i><b>1.3.2</b> Example: Poisson SD<span></span></a></li>
<li class="chapter" data-level="1.3.3" data-path="the-invariance-property.html"><a href="the-invariance-property.html#example-beta-mean-and-variance"><i class="fa fa-check"></i><b>1.3.3</b> Example: Beta Mean and Variance<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html"><i class="fa fa-check"></i><b>1.4</b> The Parametric Bootstrap<span></span></a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#example-toothpaste-cap-problm"><i class="fa fa-check"></i><b>1.4.1</b> Example: Toothpaste Cap Problm<span></span></a></li>
<li class="chapter" data-level="1.4.2" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#example-beta-distribution-1"><i class="fa fa-check"></i><b>1.4.2</b> Example: Beta Distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sampling-distribution.html"><a href="sampling-distribution.html"><i class="fa fa-check"></i><b>1.5</b> Sampling Distribution<span></span></a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sampling-distribution.html"><a href="sampling-distribution.html#example-the-toothpaste-cap-problem"><i class="fa fa-check"></i><b>1.5.1</b> Example: The Toothpaste Cap Problem<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="bias.html"><a href="bias.html"><i class="fa fa-check"></i><b>1.6</b> Bias<span></span></a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="bias.html"><a href="bias.html#example-bernoulli-distribution-1"><i class="fa fa-check"></i><b>1.6.1</b> Example: Bernoulli Distribution<span></span></a></li>
<li class="chapter" data-level="1.6.2" data-path="bias.html"><a href="bias.html#example-poisson-distribution-1"><i class="fa fa-check"></i><b>1.6.2</b> Example: Poisson Distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="consistency.html"><a href="consistency.html"><i class="fa fa-check"></i><b>1.7</b> Consistency<span></span></a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="consistency.html"><a href="consistency.html#example-illustrative"><i class="fa fa-check"></i><b>1.7.1</b> Example: Illustrative<span></span></a></li>
<li class="chapter" data-level="1.7.2" data-path="consistency.html"><a href="consistency.html#example-bernoulli-odds-1"><i class="fa fa-check"></i><b>1.7.2</b> Example: Bernoulli Odds<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="predictive-distribution.html"><a href="predictive-distribution.html"><i class="fa fa-check"></i><b>1.8</b> Predictive Distribution<span></span></a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="predictive-distribution.html"><a href="predictive-distribution.html#example-poisson-distribution-2"><i class="fa fa-check"></i><b>1.8.1</b> Example: Poisson Distribution<span></span></a></li>
<li class="chapter" data-level="1.8.2" data-path="predictive-distribution.html"><a href="predictive-distribution.html#example-beta-distribution-2"><i class="fa fa-check"></i><b>1.8.2</b> Example: Beta Distribution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-2-bayesian-inference.html"><a href="week-2-bayesian-inference.html"><i class="fa fa-check"></i><b>2</b> Week 2: Bayesian Inference<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>2.1</b> Bayesian Inference<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#mechanics"><i class="fa fa-check"></i><b>2.1.1</b> Mechanics<span></span></a></li>
<li class="chapter" data-level="2.1.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#posterior-summaries"><i class="fa fa-check"></i><b>2.1.2</b> Posterior Summaries<span></span></a></li>
<li class="chapter" data-level="2.1.3" data-path="bayesian-inference.html"><a href="bayesian-inference.html#posterior-simulation"><i class="fa fa-check"></i><b>2.1.3</b> Posterior Simulation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="example-bernoulli.html"><a href="example-bernoulli.html"><i class="fa fa-check"></i><b>2.2</b> Example: Bernoulli<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="example-bernoulli.html"><a href="example-bernoulli.html#likelihood"><i class="fa fa-check"></i><b>2.2.1</b> The Likelihood<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="example-bernoulli.html"><a href="example-bernoulli.html#the-prior"><i class="fa fa-check"></i><b>2.2.2</b> The Prior<span></span></a></li>
<li class="chapter" data-level="2.2.3" data-path="example-bernoulli.html"><a href="example-bernoulli.html#the-posterior"><i class="fa fa-check"></i><b>2.2.3</b> The Posterior<span></span></a></li>
<li class="chapter" data-level="2.2.4" data-path="example-bernoulli.html"><a href="example-bernoulli.html#point-estimates"><i class="fa fa-check"></i><b>2.2.4</b> Point Estimates<span></span></a></li>
<li class="chapter" data-level="2.2.5" data-path="example-bernoulli.html"><a href="example-bernoulli.html#credible-interval"><i class="fa fa-check"></i><b>2.2.5</b> Credible Interval<span></span></a></li>
<li class="chapter" data-level="2.2.6" data-path="example-bernoulli.html"><a href="example-bernoulli.html#simulation"><i class="fa fa-check"></i><b>2.2.6</b> Simulation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="example-poisson-distribution-3.html"><a href="example-poisson-distribution-3.html"><i class="fa fa-check"></i><b>2.3</b> Example: Poisson Distribution<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="remarks-1.html"><a href="remarks-1.html"><i class="fa fa-check"></i><b>2.4</b> Remarks<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-3-adding-predictors.html"><a href="week-3-adding-predictors.html"><i class="fa fa-check"></i><b>3</b> Week 3: Adding Predictors<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html"><i class="fa fa-check"></i><b>3.1</b> Review: The Normal Model<span></span></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#distribution"><i class="fa fa-check"></i><b>3.1.1</b> Distribution<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#linear-predictor"><i class="fa fa-check"></i><b>3.1.2</b> Linear Predictor<span></span></a></li>
<li class="chapter" data-level="3.1.3" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#fitting-the-normal-linear-model"><i class="fa fa-check"></i><b>3.1.3</b> Fitting the Normal-Linear Model<span></span></a></li>
<li class="chapter" data-level="3.1.4" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#applied-example"><i class="fa fa-check"></i><b>3.1.4</b> Applied Example<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bernoulli-model.html"><a href="bernoulli-model.html"><i class="fa fa-check"></i><b>3.2</b> Bernoulli Model<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="bernoulli-model.html"><a href="bernoulli-model.html#the-linear-probability-model"><i class="fa fa-check"></i><b>3.2.1</b> The Linear Probability Model<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="bernoulli-model.html"><a href="bernoulli-model.html#the-logit-model"><i class="fa fa-check"></i><b>3.2.2</b> The Logit Model<span></span></a></li>
<li class="chapter" data-level="3.2.3" data-path="bernoulli-model.html"><a href="bernoulli-model.html#fitting-a-logit-model"><i class="fa fa-check"></i><b>3.2.3</b> Fitting a Logit Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="poisson-model.html"><a href="poisson-model.html"><i class="fa fa-check"></i><b>3.3</b> Poisson Model<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="poisson-model.html"><a href="poisson-model.html#predictive-distribution-1"><i class="fa fa-check"></i><b>3.3.1</b> Predictive Distribution<span></span></a></li>
<li class="chapter" data-level="3.3.2" data-path="poisson-model.html"><a href="poisson-model.html#posterior-predictive-distribution"><i class="fa fa-check"></i><b>3.3.2</b> Posterior Predictive Distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="posterior-predictive-distribution-1.html"><a href="posterior-predictive-distribution-1.html"><i class="fa fa-check"></i><b>3.4</b> [Posterior] Predictive Distribution<span></span></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="posterior-predictive-distribution-1.html"><a href="posterior-predictive-distribution-1.html#for-the-logit-model"><i class="fa fa-check"></i><b>3.4.1</b> … for the logit model<span></span></a></li>
<li class="chapter" data-level="3.4.2" data-path="posterior-predictive-distribution-1.html"><a href="posterior-predictive-distribution-1.html#for-the-poisson-model"><i class="fa fa-check"></i><b>3.4.2</b> … for the Poisson model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="quantities-of-interest.html"><a href="quantities-of-interest.html"><i class="fa fa-check"></i><b>3.5</b> Quantities of Interest<span></span></a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="quantities-of-interest.html"><a href="quantities-of-interest.html#expected-value"><i class="fa fa-check"></i><b>3.5.1</b> Expected Value<span></span></a></li>
<li class="chapter" data-level="3.5.2" data-path="quantities-of-interest.html"><a href="quantities-of-interest.html#first-difference"><i class="fa fa-check"></i><b>3.5.2</b> First Difference<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-4-confidence-intervals.html"><a href="week-4-confidence-intervals.html"><i class="fa fa-check"></i><b>4</b> Week 4: Confidence Intervals<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="the-parametric-bootstrap-1.html"><a href="the-parametric-bootstrap-1.html"><i class="fa fa-check"></i><b>4.1</b> The Parametric Bootstrap<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="the-nonparametric-bootstrap.html"><a href="the-nonparametric-bootstrap.html"><i class="fa fa-check"></i><b>4.2</b> The <em>Non</em>parametric Bootstrap<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="the-nonparametric-bootstrap.html"><a href="the-nonparametric-bootstrap.html#example-coefficients-from-the-civilian-casualties-model"><i class="fa fa-check"></i><b>4.2.1</b> Example: Coefficients from the Civilian Casualties Model<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="the-nonparametric-bootstrap.html"><a href="the-nonparametric-bootstrap.html#example-first-difference-from-the-civilian-casualties-model"><i class="fa fa-check"></i><b>4.2.2</b> Example: First Difference from the Civilian Casualties Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="wald-confidence-intervals.html"><a href="wald-confidence-intervals.html"><i class="fa fa-check"></i><b>4.3</b> Wald Confidence Intervals<span></span></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="wald-confidence-intervals.html"><a href="wald-confidence-intervals.html#curvature-in-a-single-dimmension"><i class="fa fa-check"></i><b>4.3.1</b> Curvature in a Single Dimmension<span></span></a></li>
<li class="chapter" data-level="4.3.2" data-path="wald-confidence-intervals.html"><a href="wald-confidence-intervals.html#curvature-in-a-multiple-dimmensions"><i class="fa fa-check"></i><b>4.3.2</b> Curvature in a Multiple Dimmensions<span></span></a></li>
<li class="chapter" data-level="4.3.3" data-path="wald-confidence-intervals.html"><a href="wald-confidence-intervals.html#from-curvature-to-confidence-intervals"><i class="fa fa-check"></i><b>4.3.3</b> From Curvature to Confidence Intervals<span></span></a></li>
<li class="chapter" data-level="4.3.4" data-path="wald-confidence-intervals.html"><a href="wald-confidence-intervals.html#final-notes"><i class="fa fa-check"></i><b>4.3.4</b> Final Notes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="evaluating-confidence-intervals.html"><a href="evaluating-confidence-intervals.html"><i class="fa fa-check"></i><b>4.4</b> Evaluating Confidence Intervals<span></span></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="evaluating-confidence-intervals.html"><a href="evaluating-confidence-intervals.html#coverage"><i class="fa fa-check"></i><b>4.4.1</b> Coverage<span></span></a></li>
<li class="chapter" data-level="4.4.2" data-path="evaluating-confidence-intervals.html"><a href="evaluating-confidence-intervals.html#monte-carlo-simulation-to-assess-coverage"><i class="fa fa-check"></i><b>4.4.2</b> Monte Carlo Simulation to Assess Coverage<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week-5-models-of-binary-outcomes-and-model-fit-summaries.html"><a href="week-5-models-of-binary-outcomes-and-model-fit-summaries.html"><i class="fa fa-check"></i><b>5</b> Week 5: Models of Binary Outcomes and Model Fit Summaries<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="measures-of-model-fit.html"><a href="measures-of-model-fit.html"><i class="fa fa-check"></i><b>5.1</b> Measures of Model Fit<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="measures-of-model-fit.html"><a href="measures-of-model-fit.html#scoring-binary-predictions"><i class="fa fa-check"></i><b>5.1.1</b> Scoring Binary Predictions<span></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="measures-of-model-fit.html"><a href="measures-of-model-fit.html#cross-validation"><i class="fa fa-check"></i><b>5.1.2</b> Cross-Validation<span></span></a></li>
<li class="chapter" data-level="5.1.3" data-path="measures-of-model-fit.html"><a href="measures-of-model-fit.html#information-criteria"><i class="fa fa-check"></i><b>5.1.3</b> Information Criteria<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html"><i class="fa fa-check"></i><b>5.2</b> Models of Binary Outcomes<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#logit"><i class="fa fa-check"></i><b>5.2.1</b> Logit<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#probit"><i class="fa fa-check"></i><b>5.2.2</b> Probit<span></span></a></li>
<li class="chapter" data-level="5.2.3" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#cloglog"><i class="fa fa-check"></i><b>5.2.3</b> Cloglog<span></span></a></li>
<li class="chapter" data-level="5.2.4" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#cauchit"><i class="fa fa-check"></i><b>5.2.4</b> Cauchit<span></span></a></li>
<li class="chapter" data-level="5.2.5" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#scobit"><i class="fa fa-check"></i><b>5.2.5</b> Scobit<span></span></a></li>
<li class="chapter" data-level="5.2.6" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#heteroskedastic-probit"><i class="fa fa-check"></i><b>5.2.6</b> Heteroskedastic Probit<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week-6-an-explosion-of-quantities-of-interest.html"><a href="week-6-an-explosion-of-quantities-of-interest.html"><i class="fa fa-check"></i><b>6</b> Week 6: An Explosion of Quantities of Interest<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="king-tomz-and-wittenberg-2001.html"><a href="king-tomz-and-wittenberg-2001.html"><i class="fa fa-check"></i><b>6.1</b> King, Tomz, and Wittenberg (2001)<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="brambor-clark-and-golder-2006.html"><a href="brambor-clark-and-golder-2006.html"><i class="fa fa-check"></i><b>6.2</b> Brambor, Clark, and Golder (2006)<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="brambor-clark-and-golder-2006.html"><a href="brambor-clark-and-golder-2006.html#a-warning-about-misinterpreting-marginal-effect-plots"><i class="fa fa-check"></i><b>6.2.1</b> A Warning about Misinterpreting Marginal Effect Plots<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="berry-golder-and-milton-2012.html"><a href="berry-golder-and-milton-2012.html"><i class="fa fa-check"></i><b>6.3</b> Berry, Golder, and Milton (2012)<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="berry-demeritt-and-esarey-2010.html"><a href="berry-demeritt-and-esarey-2010.html"><i class="fa fa-check"></i><b>6.4</b> Berry, DeMeritt, and Esarey (2010)<span></span></a></li>
<li class="chapter" data-level="6.5" data-path="rainey-2016.html"><a href="rainey-2016.html"><i class="fa fa-check"></i><b>6.5</b> Rainey (2016)<span></span></a></li>
<li class="chapter" data-level="6.6" data-path="hanmer-and-kalkan-2013.html"><a href="hanmer-and-kalkan-2013.html"><i class="fa fa-check"></i><b>6.6</b> Hanmer and Kalkan (2013)<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modeling: A Tools Approach</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hanmer-and-kalkan-2013" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Hanmer and Kalkan (2013)<a href="hanmer-and-kalkan-2013.html#hanmer-and-kalkan-2013" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hanmer and Kalkan (2013) make an important observation: a “typical” scenario <span class="math inline">\(X_s\)</span> might product an atypical quantity of interest.</p>
<p>To remedy these concerns, they suggest setting the “other” covariate to all combinations that appear in the data set, compute the quantity of interest for all those scenarios, and then average them.</p>
<p>First, let’s see how the second difference from the previous chapter varies across all the existing combinations of the other covariates. We don’t need a CI, so we don’t need to use KTW’s simulation method–we can just use <code>predict()</code>.</p>
<p>This can be numerically demanding, so I’m taking a random sample of 5,000 observations from BDE’s example data set to illustrate the computation.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="hanmer-and-kalkan-2013.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb336-2"><a href="hanmer-and-kalkan-2013.html#cb336-2" aria-hidden="true" tabindex="-1"></a>scobit <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">&quot;data/scobit.dta&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb336-3"><a href="hanmer-and-kalkan-2013.html#cb336-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(newvote <span class="sc">!=</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb336-4"><a href="hanmer-and-kalkan-2013.html#cb336-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">5000</span>)</span>
<span id="cb336-5"><a href="hanmer-and-kalkan-2013.html#cb336-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-6"><a href="hanmer-and-kalkan-2013.html#cb336-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model (nagler&#39;s specification in bde table 1 on p. 263)</span></span>
<span id="cb336-7"><a href="hanmer-and-kalkan-2013.html#cb336-7" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> newvote <span class="sc">~</span> <span class="fu">poly</span>(neweduc, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> closing <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> south <span class="sc">+</span> gov</span>
<span id="cb336-8"><a href="hanmer-and-kalkan-2013.html#cb336-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(f, <span class="at">data =</span> scobit, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>))</span>
<span id="cb336-9"><a href="hanmer-and-kalkan-2013.html#cb336-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-10"><a href="hanmer-and-kalkan-2013.html#cb336-10" aria-hidden="true" tabindex="-1"></a><span class="co"># four scenarios of the second difference; 10th to 90th percentile for both</span></span>
<span id="cb336-11"><a href="hanmer-and-kalkan-2013.html#cb336-11" aria-hidden="true" tabindex="-1"></a><span class="co"># note: 1st lo/hi refers to neweduc; 2nd refers to closing</span></span>
<span id="cb336-12"><a href="hanmer-and-kalkan-2013.html#cb336-12" aria-hidden="true" tabindex="-1"></a>s_lo_lo <span class="ot">&lt;-</span> scobit <span class="sc">%&gt;%</span>           <span class="co"># start with the observed data set</span></span>
<span id="cb336-13"><a href="hanmer-and-kalkan-2013.html#cb336-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, south, gov) <span class="sc">%&gt;%</span>   <span class="co"># select the &quot;other&quot; covariates</span></span>
<span id="cb336-14"><a href="hanmer-and-kalkan-2013.html#cb336-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb336-15"><a href="hanmer-and-kalkan-2013.html#cb336-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>))</span>
<span id="cb336-16"><a href="hanmer-and-kalkan-2013.html#cb336-16" aria-hidden="true" tabindex="-1"></a>pi_lo_lo_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> s_lo_lo, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb336-17"><a href="hanmer-and-kalkan-2013.html#cb336-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-18"><a href="hanmer-and-kalkan-2013.html#cb336-18" aria-hidden="true" tabindex="-1"></a>s_hi_lo <span class="ot">&lt;-</span> scobit <span class="sc">%&gt;%</span>           <span class="co"># start with the observed data set</span></span>
<span id="cb336-19"><a href="hanmer-and-kalkan-2013.html#cb336-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, south, gov) <span class="sc">%&gt;%</span>   <span class="co"># select the &quot;other&quot; covariates</span></span>
<span id="cb336-20"><a href="hanmer-and-kalkan-2013.html#cb336-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb336-21"><a href="hanmer-and-kalkan-2013.html#cb336-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>))</span>
<span id="cb336-22"><a href="hanmer-and-kalkan-2013.html#cb336-22" aria-hidden="true" tabindex="-1"></a>pi_hi_lo_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> s_hi_lo, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb336-23"><a href="hanmer-and-kalkan-2013.html#cb336-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-24"><a href="hanmer-and-kalkan-2013.html#cb336-24" aria-hidden="true" tabindex="-1"></a>s_lo_hi <span class="ot">&lt;-</span> scobit <span class="sc">%&gt;%</span>           <span class="co"># start with the observed data set</span></span>
<span id="cb336-25"><a href="hanmer-and-kalkan-2013.html#cb336-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, south, gov) <span class="sc">%&gt;%</span>   <span class="co"># select the &quot;other&quot; covariates</span></span>
<span id="cb336-26"><a href="hanmer-and-kalkan-2013.html#cb336-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb336-27"><a href="hanmer-and-kalkan-2013.html#cb336-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>))</span>
<span id="cb336-28"><a href="hanmer-and-kalkan-2013.html#cb336-28" aria-hidden="true" tabindex="-1"></a>pi_lo_hi_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> s_lo_hi, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb336-29"><a href="hanmer-and-kalkan-2013.html#cb336-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-30"><a href="hanmer-and-kalkan-2013.html#cb336-30" aria-hidden="true" tabindex="-1"></a>s_hi_hi <span class="ot">&lt;-</span> scobit <span class="sc">%&gt;%</span>           <span class="co"># start with the observed data set</span></span>
<span id="cb336-31"><a href="hanmer-and-kalkan-2013.html#cb336-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, south, gov) <span class="sc">%&gt;%</span>   <span class="co"># select the &quot;other&quot; covariates</span></span>
<span id="cb336-32"><a href="hanmer-and-kalkan-2013.html#cb336-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb336-33"><a href="hanmer-and-kalkan-2013.html#cb336-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>))</span>
<span id="cb336-34"><a href="hanmer-and-kalkan-2013.html#cb336-34" aria-hidden="true" tabindex="-1"></a>pi_hi_hi_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> s_hi_hi, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb336-35"><a href="hanmer-and-kalkan-2013.html#cb336-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-36"><a href="hanmer-and-kalkan-2013.html#cb336-36" aria-hidden="true" tabindex="-1"></a><span class="co"># ml estimate</span></span>
<span id="cb336-37"><a href="hanmer-and-kalkan-2013.html#cb336-37" aria-hidden="true" tabindex="-1"></a>dd_hat <span class="ot">&lt;-</span> (pi_hi_hi_hat <span class="sc">-</span> pi_lo_hi_hat) <span class="sc">-</span>   <span class="co"># effect of education when closing is high</span></span>
<span id="cb336-38"><a href="hanmer-and-kalkan-2013.html#cb336-38" aria-hidden="true" tabindex="-1"></a>  (pi_hi_lo_hat <span class="sc">-</span> pi_lo_lo_hat)   <span class="co"># effect of education when closing is low</span></span>
<span id="cb336-39"><a href="hanmer-and-kalkan-2013.html#cb336-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-40"><a href="hanmer-and-kalkan-2013.html#cb336-40" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(dd_hat, <span class="at">bins =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img src="06-04-hk_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="hanmer-and-kalkan-2013.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dd_hat)</span></code></pre></div>
<pre><code>## [1] 0.002918702</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="hanmer-and-kalkan-2013.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(dd_hat)</span></code></pre></div>
<pre><code>## [1] 0.002185804</code></pre>
<p>You can see that we get quite a lot of variation in the quantity of interest, depending on the value we choose for the other covariates.</p>
<p>I’ve chatting with Michael Hanmer about this, and I think he agrees with me that it’s valuable to at least compute (if not present in the paper) the variation in the quantity of interest across all observed values of the other covariates. Knowing the distribution (in addition to the average) is helpful. We might descibe the second difference here as about 0.005, give or take 0.003 or so, depending on the values of the other covariates.</p>
<p>The we can use KTW’s method to get a confidence interval for the average across the observed values.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="hanmer-and-kalkan-2013.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate beta_tildes using KTW&#39;s method</span></span>
<span id="cb341-2"><a href="hanmer-and-kalkan-2013.html#cb341-2" aria-hidden="true" tabindex="-1"></a>beta_tilde <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">2000</span>, <span class="at">mean =</span> <span class="fu">coef</span>(fit), <span class="at">sigma =</span> <span class="fu">vcov</span>(fit))</span>
<span id="cb341-3"><a href="hanmer-and-kalkan-2013.html#cb341-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-4"><a href="hanmer-and-kalkan-2013.html#cb341-4" aria-hidden="true" tabindex="-1"></a><span class="co"># four scenarios of the second difference; 10th to 90th percentile for both</span></span>
<span id="cb341-5"><a href="hanmer-and-kalkan-2013.html#cb341-5" aria-hidden="true" tabindex="-1"></a><span class="co"># note: 1st lo/hi refers to neweduc; 2nd refers to closing</span></span>
<span id="cb341-6"><a href="hanmer-and-kalkan-2013.html#cb341-6" aria-hidden="true" tabindex="-1"></a>s_lo_lo <span class="ot">&lt;-</span> scobit <span class="sc">%&gt;%</span>           <span class="co"># start with the observed data set</span></span>
<span id="cb341-7"><a href="hanmer-and-kalkan-2013.html#cb341-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, south, gov) <span class="sc">%&gt;%</span>   <span class="co"># select the &quot;other&quot; covariates</span></span>
<span id="cb341-8"><a href="hanmer-and-kalkan-2013.html#cb341-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb341-9"><a href="hanmer-and-kalkan-2013.html#cb341-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>))</span>
<span id="cb341-10"><a href="hanmer-and-kalkan-2013.html#cb341-10" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb341-11"><a href="hanmer-and-kalkan-2013.html#cb341-11" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_lo_lo)</span>
<span id="cb341-12"><a href="hanmer-and-kalkan-2013.html#cb341-12" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_lo_lo)</span>
<span id="cb341-13"><a href="hanmer-and-kalkan-2013.html#cb341-13" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb341-14"><a href="hanmer-and-kalkan-2013.html#cb341-14" aria-hidden="true" tabindex="-1"></a>pi_lo_lo_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb341-15"><a href="hanmer-and-kalkan-2013.html#cb341-15" aria-hidden="true" tabindex="-1"></a><span class="co"># note: I only care to &quot;keep&quot; things with the _lo_lo tag, everything </span></span>
<span id="cb341-16"><a href="hanmer-and-kalkan-2013.html#cb341-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   else gets overwritten below.</span></span>
<span id="cb341-17"><a href="hanmer-and-kalkan-2013.html#cb341-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-18"><a href="hanmer-and-kalkan-2013.html#cb341-18" aria-hidden="true" tabindex="-1"></a><span class="co"># hi; lo</span></span>
<span id="cb341-19"><a href="hanmer-and-kalkan-2013.html#cb341-19" aria-hidden="true" tabindex="-1"></a>s_hi_lo <span class="ot">&lt;-</span> scobit <span class="sc">%&gt;%</span>           <span class="co"># start with the observed data set</span></span>
<span id="cb341-20"><a href="hanmer-and-kalkan-2013.html#cb341-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, south, gov) <span class="sc">%&gt;%</span>   <span class="co"># select the &quot;other&quot; covariates</span></span>
<span id="cb341-21"><a href="hanmer-and-kalkan-2013.html#cb341-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb341-22"><a href="hanmer-and-kalkan-2013.html#cb341-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>)) </span>
<span id="cb341-23"><a href="hanmer-and-kalkan-2013.html#cb341-23" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb341-24"><a href="hanmer-and-kalkan-2013.html#cb341-24" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_hi_lo)</span>
<span id="cb341-25"><a href="hanmer-and-kalkan-2013.html#cb341-25" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_hi_lo)</span>
<span id="cb341-26"><a href="hanmer-and-kalkan-2013.html#cb341-26" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb341-27"><a href="hanmer-and-kalkan-2013.html#cb341-27" aria-hidden="true" tabindex="-1"></a>pi_hi_lo_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb341-28"><a href="hanmer-and-kalkan-2013.html#cb341-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-29"><a href="hanmer-and-kalkan-2013.html#cb341-29" aria-hidden="true" tabindex="-1"></a><span class="co"># lo; hi</span></span>
<span id="cb341-30"><a href="hanmer-and-kalkan-2013.html#cb341-30" aria-hidden="true" tabindex="-1"></a>s_lo_hi <span class="ot">&lt;-</span> scobit <span class="sc">%&gt;%</span>           <span class="co"># start with the observed data set</span></span>
<span id="cb341-31"><a href="hanmer-and-kalkan-2013.html#cb341-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, south, gov) <span class="sc">%&gt;%</span>   <span class="co"># select the &quot;other&quot; covariates</span></span>
<span id="cb341-32"><a href="hanmer-and-kalkan-2013.html#cb341-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb341-33"><a href="hanmer-and-kalkan-2013.html#cb341-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>)) </span>
<span id="cb341-34"><a href="hanmer-and-kalkan-2013.html#cb341-34" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb341-35"><a href="hanmer-and-kalkan-2013.html#cb341-35" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_lo_hi)</span>
<span id="cb341-36"><a href="hanmer-and-kalkan-2013.html#cb341-36" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_lo_hi)</span>
<span id="cb341-37"><a href="hanmer-and-kalkan-2013.html#cb341-37" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb341-38"><a href="hanmer-and-kalkan-2013.html#cb341-38" aria-hidden="true" tabindex="-1"></a>pi_lo_hi_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb341-39"><a href="hanmer-and-kalkan-2013.html#cb341-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-40"><a href="hanmer-and-kalkan-2013.html#cb341-40" aria-hidden="true" tabindex="-1"></a><span class="co"># hi; hi</span></span>
<span id="cb341-41"><a href="hanmer-and-kalkan-2013.html#cb341-41" aria-hidden="true" tabindex="-1"></a>s_hi_hi <span class="ot">&lt;-</span> scobit <span class="sc">%&gt;%</span>           <span class="co"># start with the observed data set</span></span>
<span id="cb341-42"><a href="hanmer-and-kalkan-2013.html#cb341-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, south, gov) <span class="sc">%&gt;%</span>   <span class="co"># select the &quot;other&quot; covariates</span></span>
<span id="cb341-43"><a href="hanmer-and-kalkan-2013.html#cb341-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb341-44"><a href="hanmer-and-kalkan-2013.html#cb341-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>)) </span>
<span id="cb341-45"><a href="hanmer-and-kalkan-2013.html#cb341-45" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb341-46"><a href="hanmer-and-kalkan-2013.html#cb341-46" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_hi_hi)</span>
<span id="cb341-47"><a href="hanmer-and-kalkan-2013.html#cb341-47" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_hi_hi)</span>
<span id="cb341-48"><a href="hanmer-and-kalkan-2013.html#cb341-48" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb341-49"><a href="hanmer-and-kalkan-2013.html#cb341-49" aria-hidden="true" tabindex="-1"></a>pi_hi_hi_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb341-50"><a href="hanmer-and-kalkan-2013.html#cb341-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-51"><a href="hanmer-and-kalkan-2013.html#cb341-51" aria-hidden="true" tabindex="-1"></a><span class="co"># ktw simulations of second difference</span></span>
<span id="cb341-52"><a href="hanmer-and-kalkan-2013.html#cb341-52" aria-hidden="true" tabindex="-1"></a>dd_tilde <span class="ot">&lt;-</span> (pi_hi_hi_tilde <span class="sc">-</span> pi_lo_hi_tilde) <span class="sc">-</span>   <span class="co"># effect of education when closing is high</span></span>
<span id="cb341-53"><a href="hanmer-and-kalkan-2013.html#cb341-53" aria-hidden="true" tabindex="-1"></a>  (pi_hi_lo_tilde <span class="sc">-</span> pi_lo_lo_tilde)               <span class="co"># effect of education when closing is low</span></span>
<span id="cb341-54"><a href="hanmer-and-kalkan-2013.html#cb341-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-55"><a href="hanmer-and-kalkan-2013.html#cb341-55" aria-hidden="true" tabindex="-1"></a>avg_dd_tilde <span class="ot">&lt;-</span> <span class="fu">apply</span>(dd_tilde, <span class="dv">2</span>, mean)</span>
<span id="cb341-56"><a href="hanmer-and-kalkan-2013.html#cb341-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-57"><a href="hanmer-and-kalkan-2013.html#cb341-57" aria-hidden="true" tabindex="-1"></a><span class="co"># 90% CI using ktw simulations</span></span>
<span id="cb341-58"><a href="hanmer-and-kalkan-2013.html#cb341-58" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(avg_dd_tilde, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span></code></pre></div>
<pre><code>##          5%         95% 
## 0.002731359 0.014179453</code></pre>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="rainey-2016.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["adv-methods-notes.pdf", "adv-methods-notes.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
