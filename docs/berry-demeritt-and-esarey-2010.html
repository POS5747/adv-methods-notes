<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.4 Berry, DeMeritt, and Esarey (2010) | Statistical Modeling: A Tools Approach</title>
  <meta name="description" content="Lecture notes covering the key tools of regression modeling in political science." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="6.4 Berry, DeMeritt, and Esarey (2010) | Statistical Modeling: A Tools Approach" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Lecture notes covering the key tools of regression modeling in political science." />
  <meta name="github-repo" content="pos5747/adv-methods-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.4 Berry, DeMeritt, and Esarey (2010) | Statistical Modeling: A Tools Approach" />
  
  <meta name="twitter:description" content="Lecture notes covering the key tools of regression modeling in political science." />
  

<meta name="author" content="Carlisle Rainey" />


<meta name="date" content="2022-11-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="berry-golder-and-milton-2012.html"/>
<link rel="next" href="rainey-2016.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script>
    $(document).ready(function () {
        process_solutions();
    });
    function process_solutions() {
        $("div.section[id^='solution']").each(function(i) {
        var soln_wrapper_id = "cvxr_ex_" + i;
        var solution_id = $(this).attr('id');
        var button = $("<button onclick=\"toggle_solution('" + soln_wrapper_id + "')\">Show/Hide</button>");
        var new_div = $("<div id='" + soln_wrapper_id + "' class='solution' style='display: none;'></div>");
        var h = $(this).first();
        var others = $(this).children().slice(1);
        $(others).each(function() {
            $(this).appendTo($(new_div));
        });
        $(button).insertAfter($(h));
        $(new_div).insertAfter($(button));
        })
    }
    function toggle_solution(el_id) {
      $("#" + el_id).toggle();
    } 
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Methods Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Week 1: Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="1.1" data-path="class-agenda.html"><a href="class-agenda.html"><i class="fa fa-check"></i><b>1.1</b> Class agenda</a></li>
<li class="chapter" data-level="1.2" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i><b>1.2</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-bernoulli-distribution"><i class="fa fa-check"></i><b>1.2.1</b> Example: Bernoulli Distribution</a></li>
<li class="chapter" data-level="1.2.2" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-poisson-distribution"><i class="fa fa-check"></i><b>1.2.2</b> Example: Poisson Distribution</a></li>
<li class="chapter" data-level="1.2.3" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#remarks"><i class="fa fa-check"></i><b>1.2.3</b> Remarks</a></li>
<li class="chapter" data-level="1.2.4" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-beta-distribution"><i class="fa fa-check"></i><b>1.2.4</b> Example: Beta Distribution</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="the-invariance-property.html"><a href="the-invariance-property.html"><i class="fa fa-check"></i><b>1.3</b> The Invariance Property</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="the-invariance-property.html"><a href="the-invariance-property.html#example-bernoulli-odds"><i class="fa fa-check"></i><b>1.3.1</b> Example: Bernoulli Odds</a></li>
<li class="chapter" data-level="1.3.2" data-path="the-invariance-property.html"><a href="the-invariance-property.html#example-poisson-sd"><i class="fa fa-check"></i><b>1.3.2</b> Example: Poisson SD</a></li>
<li class="chapter" data-level="1.3.3" data-path="the-invariance-property.html"><a href="the-invariance-property.html#example-beta-mean-and-variance"><i class="fa fa-check"></i><b>1.3.3</b> Example: Beta Mean and Variance</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html"><i class="fa fa-check"></i><b>1.4</b> The Parametric Bootstrap</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#example-toothpaste-cap-problm"><i class="fa fa-check"></i><b>1.4.1</b> Example: Toothpaste Cap Problm</a></li>
<li class="chapter" data-level="1.4.2" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#example-beta-distribution-1"><i class="fa fa-check"></i><b>1.4.2</b> Example: Beta Distribution</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sampling-distribution.html"><a href="sampling-distribution.html"><i class="fa fa-check"></i><b>1.5</b> Sampling Distribution</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sampling-distribution.html"><a href="sampling-distribution.html#example-the-toothpaste-cap-problem"><i class="fa fa-check"></i><b>1.5.1</b> Example: The Toothpaste Cap Problem</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="bias.html"><a href="bias.html"><i class="fa fa-check"></i><b>1.6</b> Bias</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="bias.html"><a href="bias.html#example-bernoulli-distribution-1"><i class="fa fa-check"></i><b>1.6.1</b> Example: Bernoulli Distribution</a></li>
<li class="chapter" data-level="1.6.2" data-path="bias.html"><a href="bias.html#example-poisson-distribution-1"><i class="fa fa-check"></i><b>1.6.2</b> Example: Poisson Distribution</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="consistency.html"><a href="consistency.html"><i class="fa fa-check"></i><b>1.7</b> Consistency</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="consistency.html"><a href="consistency.html#example-illustrative"><i class="fa fa-check"></i><b>1.7.1</b> Example: Illustrative</a></li>
<li class="chapter" data-level="1.7.2" data-path="consistency.html"><a href="consistency.html#example-bernoulli-odds-1"><i class="fa fa-check"></i><b>1.7.2</b> Example: Bernoulli Odds</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="predictive-distribution.html"><a href="predictive-distribution.html"><i class="fa fa-check"></i><b>1.8</b> Predictive Distribution</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="predictive-distribution.html"><a href="predictive-distribution.html#example-poisson-distribution-2"><i class="fa fa-check"></i><b>1.8.1</b> Example: Poisson Distribution</a></li>
<li class="chapter" data-level="1.8.2" data-path="predictive-distribution.html"><a href="predictive-distribution.html#example-beta-distribution-2"><i class="fa fa-check"></i><b>1.8.2</b> Example: Beta Distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-2-bayesian-inference.html"><a href="week-2-bayesian-inference.html"><i class="fa fa-check"></i><b>2</b> Week 2: Bayesian Inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>2.1</b> Bayesian Inference</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#mechanics"><i class="fa fa-check"></i><b>2.1.1</b> Mechanics</a></li>
<li class="chapter" data-level="2.1.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#posterior-summaries"><i class="fa fa-check"></i><b>2.1.2</b> Posterior Summaries</a></li>
<li class="chapter" data-level="2.1.3" data-path="bayesian-inference.html"><a href="bayesian-inference.html#posterior-simulation"><i class="fa fa-check"></i><b>2.1.3</b> Posterior Simulation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="example-bernoulli.html"><a href="example-bernoulli.html"><i class="fa fa-check"></i><b>2.2</b> Example: Bernoulli</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="example-bernoulli.html"><a href="example-bernoulli.html#likelihood"><i class="fa fa-check"></i><b>2.2.1</b> The Likelihood</a></li>
<li class="chapter" data-level="2.2.2" data-path="example-bernoulli.html"><a href="example-bernoulli.html#the-prior"><i class="fa fa-check"></i><b>2.2.2</b> The Prior</a></li>
<li class="chapter" data-level="2.2.3" data-path="example-bernoulli.html"><a href="example-bernoulli.html#the-posterior"><i class="fa fa-check"></i><b>2.2.3</b> The Posterior</a></li>
<li class="chapter" data-level="2.2.4" data-path="example-bernoulli.html"><a href="example-bernoulli.html#point-estimates"><i class="fa fa-check"></i><b>2.2.4</b> Point Estimates</a></li>
<li class="chapter" data-level="2.2.5" data-path="example-bernoulli.html"><a href="example-bernoulli.html#credible-interval"><i class="fa fa-check"></i><b>2.2.5</b> Credible Interval</a></li>
<li class="chapter" data-level="2.2.6" data-path="example-bernoulli.html"><a href="example-bernoulli.html#simulation"><i class="fa fa-check"></i><b>2.2.6</b> Simulation</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="example-poisson-distribution-3.html"><a href="example-poisson-distribution-3.html"><i class="fa fa-check"></i><b>2.3</b> Example: Poisson Distribution</a></li>
<li class="chapter" data-level="2.4" data-path="remarks-1.html"><a href="remarks-1.html"><i class="fa fa-check"></i><b>2.4</b> Remarks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-3-adding-predictors.html"><a href="week-3-adding-predictors.html"><i class="fa fa-check"></i><b>3</b> Week 3: Adding Predictors</a>
<ul>
<li class="chapter" data-level="3.1" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html"><i class="fa fa-check"></i><b>3.1</b> Review: The Normal Model</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#distribution"><i class="fa fa-check"></i><b>3.1.1</b> Distribution</a></li>
<li class="chapter" data-level="3.1.2" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#linear-predictor"><i class="fa fa-check"></i><b>3.1.2</b> Linear Predictor</a></li>
<li class="chapter" data-level="3.1.3" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#fitting-the-normal-linear-model"><i class="fa fa-check"></i><b>3.1.3</b> Fitting the Normal-Linear Model</a></li>
<li class="chapter" data-level="3.1.4" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#applied-example"><i class="fa fa-check"></i><b>3.1.4</b> Applied Example</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bernoulli-model.html"><a href="bernoulli-model.html"><i class="fa fa-check"></i><b>3.2</b> Bernoulli Model</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="bernoulli-model.html"><a href="bernoulli-model.html#the-linear-probability-model"><i class="fa fa-check"></i><b>3.2.1</b> The Linear Probability Model</a></li>
<li class="chapter" data-level="3.2.2" data-path="bernoulli-model.html"><a href="bernoulli-model.html#the-logit-model"><i class="fa fa-check"></i><b>3.2.2</b> The Logit Model</a></li>
<li class="chapter" data-level="3.2.3" data-path="bernoulli-model.html"><a href="bernoulli-model.html#fitting-a-logit-model"><i class="fa fa-check"></i><b>3.2.3</b> Fitting a Logit Model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="poisson-model.html"><a href="poisson-model.html"><i class="fa fa-check"></i><b>3.3</b> Poisson Model</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="poisson-model.html"><a href="poisson-model.html#predictive-distribution-1"><i class="fa fa-check"></i><b>3.3.1</b> Predictive Distribution</a></li>
<li class="chapter" data-level="3.3.2" data-path="poisson-model.html"><a href="poisson-model.html#posterior-predictive-distribution"><i class="fa fa-check"></i><b>3.3.2</b> Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="posterior-predictive-distribution-1.html"><a href="posterior-predictive-distribution-1.html"><i class="fa fa-check"></i><b>3.4</b> [Posterior] Predictive Distribution</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="posterior-predictive-distribution-1.html"><a href="posterior-predictive-distribution-1.html#for-the-logit-model"><i class="fa fa-check"></i><b>3.4.1</b> … for the logit model</a></li>
<li class="chapter" data-level="3.4.2" data-path="posterior-predictive-distribution-1.html"><a href="posterior-predictive-distribution-1.html#for-the-poisson-model"><i class="fa fa-check"></i><b>3.4.2</b> … for the Poisson model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="quantities-of-interest.html"><a href="quantities-of-interest.html"><i class="fa fa-check"></i><b>3.5</b> Quantities of Interest</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="quantities-of-interest.html"><a href="quantities-of-interest.html#expected-value"><i class="fa fa-check"></i><b>3.5.1</b> Expected Value</a></li>
<li class="chapter" data-level="3.5.2" data-path="quantities-of-interest.html"><a href="quantities-of-interest.html#first-difference"><i class="fa fa-check"></i><b>3.5.2</b> First Difference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-4-confidence-intervals.html"><a href="week-4-confidence-intervals.html"><i class="fa fa-check"></i><b>4</b> Week 4: Confidence Intervals</a>
<ul>
<li class="chapter" data-level="4.1" data-path="the-parametric-bootstrap-1.html"><a href="the-parametric-bootstrap-1.html"><i class="fa fa-check"></i><b>4.1</b> The Parametric Bootstrap</a></li>
<li class="chapter" data-level="4.2" data-path="the-nonparametric-bootstrap.html"><a href="the-nonparametric-bootstrap.html"><i class="fa fa-check"></i><b>4.2</b> The <em>Non</em>parametric Bootstrap</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="the-nonparametric-bootstrap.html"><a href="the-nonparametric-bootstrap.html#example-coefficients-from-the-civilian-casualties-model"><i class="fa fa-check"></i><b>4.2.1</b> Example: Coefficients from the Civilian Casualties Model</a></li>
<li class="chapter" data-level="4.2.2" data-path="the-nonparametric-bootstrap.html"><a href="the-nonparametric-bootstrap.html#example-first-difference-from-the-civilian-casualties-model"><i class="fa fa-check"></i><b>4.2.2</b> Example: First Difference from the Civilian Casualties Model</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="wald-confidence-intervals.html"><a href="wald-confidence-intervals.html"><i class="fa fa-check"></i><b>4.3</b> Wald Confidence Intervals</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="wald-confidence-intervals.html"><a href="wald-confidence-intervals.html#curvature-in-a-single-dimmension"><i class="fa fa-check"></i><b>4.3.1</b> Curvature in a Single Dimmension</a></li>
<li class="chapter" data-level="4.3.2" data-path="wald-confidence-intervals.html"><a href="wald-confidence-intervals.html#curvature-in-a-multiple-dimmensions"><i class="fa fa-check"></i><b>4.3.2</b> Curvature in a Multiple Dimmensions</a></li>
<li class="chapter" data-level="4.3.3" data-path="wald-confidence-intervals.html"><a href="wald-confidence-intervals.html#from-curvature-to-confidence-intervals"><i class="fa fa-check"></i><b>4.3.3</b> From Curvature to Confidence Intervals</a></li>
<li class="chapter" data-level="4.3.4" data-path="wald-confidence-intervals.html"><a href="wald-confidence-intervals.html#final-notes"><i class="fa fa-check"></i><b>4.3.4</b> Final Notes</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="evaluating-confidence-intervals.html"><a href="evaluating-confidence-intervals.html"><i class="fa fa-check"></i><b>4.4</b> Evaluating Confidence Intervals</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="evaluating-confidence-intervals.html"><a href="evaluating-confidence-intervals.html#coverage"><i class="fa fa-check"></i><b>4.4.1</b> Coverage</a></li>
<li class="chapter" data-level="4.4.2" data-path="evaluating-confidence-intervals.html"><a href="evaluating-confidence-intervals.html#monte-carlo-simulation-to-assess-coverage"><i class="fa fa-check"></i><b>4.4.2</b> Monte Carlo Simulation to Assess Coverage</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week-5-models-of-binary-outcomes-and-model-fit-summaries.html"><a href="week-5-models-of-binary-outcomes-and-model-fit-summaries.html"><i class="fa fa-check"></i><b>5</b> Week 5: Models of Binary Outcomes and Model Fit Summaries</a>
<ul>
<li class="chapter" data-level="5.1" data-path="measures-of-model-fit.html"><a href="measures-of-model-fit.html"><i class="fa fa-check"></i><b>5.1</b> Measures of Model Fit</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="measures-of-model-fit.html"><a href="measures-of-model-fit.html#scoring-binary-predictions"><i class="fa fa-check"></i><b>5.1.1</b> Scoring Binary Predictions</a></li>
<li class="chapter" data-level="5.1.2" data-path="measures-of-model-fit.html"><a href="measures-of-model-fit.html#cross-validation"><i class="fa fa-check"></i><b>5.1.2</b> Cross-Validation</a></li>
<li class="chapter" data-level="5.1.3" data-path="measures-of-model-fit.html"><a href="measures-of-model-fit.html#information-criteria"><i class="fa fa-check"></i><b>5.1.3</b> Information Criteria</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html"><i class="fa fa-check"></i><b>5.2</b> Models of Binary Outcomes</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#logit"><i class="fa fa-check"></i><b>5.2.1</b> Logit</a></li>
<li class="chapter" data-level="5.2.2" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#probit"><i class="fa fa-check"></i><b>5.2.2</b> Probit</a></li>
<li class="chapter" data-level="5.2.3" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#cloglog"><i class="fa fa-check"></i><b>5.2.3</b> Cloglog</a></li>
<li class="chapter" data-level="5.2.4" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#cauchit"><i class="fa fa-check"></i><b>5.2.4</b> Cauchit</a></li>
<li class="chapter" data-level="5.2.5" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#scobit"><i class="fa fa-check"></i><b>5.2.5</b> Scobit</a></li>
<li class="chapter" data-level="5.2.6" data-path="models-of-binary-outcomes.html"><a href="models-of-binary-outcomes.html#heteroskedastic-probit"><i class="fa fa-check"></i><b>5.2.6</b> Heteroskedastic Probit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week-6-an-explosion-of-quantities-of-interest.html"><a href="week-6-an-explosion-of-quantities-of-interest.html"><i class="fa fa-check"></i><b>6</b> Week 6: An Explosion of Quantities of Interest</a>
<ul>
<li class="chapter" data-level="6.1" data-path="king-tomz-and-wittenberg-2001.html"><a href="king-tomz-and-wittenberg-2001.html"><i class="fa fa-check"></i><b>6.1</b> King, Tomz, and Wittenberg (2001)</a></li>
<li class="chapter" data-level="6.2" data-path="brambor-clark-and-golder-2006.html"><a href="brambor-clark-and-golder-2006.html"><i class="fa fa-check"></i><b>6.2</b> Brambor, Clark, and Golder (2006)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="brambor-clark-and-golder-2006.html"><a href="brambor-clark-and-golder-2006.html#a-warning-about-misinterpreting-marginal-effect-plots"><i class="fa fa-check"></i><b>6.2.1</b> A Warning about Misinterpreting Marginal Effect Plots</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="berry-golder-and-milton-2012.html"><a href="berry-golder-and-milton-2012.html"><i class="fa fa-check"></i><b>6.3</b> Berry, Golder, and Milton (2012)</a></li>
<li class="chapter" data-level="6.4" data-path="berry-demeritt-and-esarey-2010.html"><a href="berry-demeritt-and-esarey-2010.html"><i class="fa fa-check"></i><b>6.4</b> Berry, DeMeritt, and Esarey (2010)</a></li>
<li class="chapter" data-level="6.5" data-path="rainey-2016.html"><a href="rainey-2016.html"><i class="fa fa-check"></i><b>6.5</b> Rainey (2016)</a></li>
<li class="chapter" data-level="6.6" data-path="hanmer-and-kalkan-2013.html"><a href="hanmer-and-kalkan-2013.html"><i class="fa fa-check"></i><b>6.6</b> Hanmer and Kalkan (2013)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="week-12-hierarchical-models.html"><a href="week-12-hierarchical-models.html"><i class="fa fa-check"></i><b>7</b> Week 12: Hierarchical Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="example-contact-in-finland.html"><a href="example-contact-in-finland.html"><i class="fa fa-check"></i><b>7.1</b> Example: Contact in Finland</a></li>
<li class="chapter" data-level="7.2" data-path="example-contact-in-the-uk.html"><a href="example-contact-in-the-uk.html"><i class="fa fa-check"></i><b>7.2</b> Example: Contact in the UK</a></li>
<li class="chapter" data-level="7.3" data-path="hierarchical-models-in-general.html"><a href="hierarchical-models-in-general.html"><i class="fa fa-check"></i><b>7.3</b> Hierarchical Models in General</a></li>
<li class="chapter" data-level="7.4" data-path="rainey-2015.html"><a href="rainey-2015.html"><i class="fa fa-check"></i><b>7.4</b> Rainey (2015)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modeling: A Tools Approach</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="berry-demeritt-and-esarey-2010" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Berry, DeMeritt, and Esarey (2010)<a href="berry-demeritt-and-esarey-2010.html#berry-demeritt-and-esarey-2010" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Berry, DeMeritt, and Esarey (2010) make a critical point: If one is interested in the marginal effect of <span class="math inline">\(x\)</span> on <span class="math inline">\(E(\tilde{y} \mid X)\)</span>, then the product term <span class="math inline">\(x \times z\)</span> can be a misleading indicator of the modifying effect of <span class="math inline">\(z\)</span> on <span class="math inline">\(\frac{\partial E(\tilde{y} \mid X)}{\partial x}\)</span>.</p>
<p>Consider a probit model <span class="math inline">\(y_i \sim \text{Bernoulli}(\pi_i)\)</span>, where <span class="math inline">\(\pi_i = \Phi(\eta_i)\)</span> and <span class="math inline">\(\eta_i = X_i\beta\)</span>. For simplicity, let’s suppose that</p>
<p><span class="math display">\[
X_i\beta = \beta_0 + \beta_x x_i + \beta_{z} z_i + \beta_{xz}x_iz_i + \text{other terms not involving } x \text{ or } z.
\]</span>
In my mind, there are two “interaction effects” that one could compute here.</p>
<p>First, we could compute the interaction of <span class="math inline">\(x\)</span> and <span class="math inline">\(z\)</span> in influencing <span class="math inline">\(\eta\)</span>. In this case, the interaction is <span class="math inline">\(\frac{\partial^2 \pi}{\partial x \partial z}\)</span> or the analogous second-difference (and is quite complicated). BDE (2010) argue that this “is usually the case” (p. 250).</p>
<p>I’m not sure that I agree that it’s most natural to think about interaction it terms of <span class="math inline">\(\pi\)</span> or <span class="math inline">\(\Pr(y)\)</span>. BDE treat hypotheses about <span class="math inline">\(\eta\)</span> as the special case and hypotheses about <span class="math inline">\(\Pr(y)\)</span> as the “obvious” default. But social science theories are usually vague, and it takes precision to account for the compression of the probit link function in the hypothesis. As an example, a researcher might theorize that negative news coverage would have a larger impact on turning out to vote among people with higher levels of education because the most educated are paying the most attention to the news. However, this theoretical intuition does not account for the ceiling effect that the most educated experience. Contrary to BDE, I suspect that most natural place to think about interaction is “outside the link function” and in terms of <span class="math inline">\(\eta\)</span>.</p>
<p>Second, we could compute the interaction of <span class="math inline">\(x\)</span> and <span class="math inline">\(z\)</span> in influencing <span class="math inline">\(\eta\)</span>. This <em>excludes</em> the interaction “due to compression.” In this case, the interaction is just <span class="math inline">\(\frac{\partial^2 \eta}{\partial x \partial z} = \beta_{xz}\)</span>. Testing this “interaction effect” does not require computing <span class="math inline">\(\frac{\partial^2 \pi}{\partial x \partial z}\)</span> or anything beyond the standard table of coefficients and p-values. I find myself more in this camp. Unless one has a specific reason for theorizing specifically about interaction <em>due to the compression of the link function,</em> it makes more sense to focus on <span class="math inline">\(\beta_{xz}\)</span> as the “interaction effect.”</p>
<p>I think everyone writing in this literature would agree that these are two types of (or “measures of”) interaction: <span class="math inline">\(\frac{\partial^2 \pi}{\partial x \partial z}\)</span> and <span class="math inline">\(\frac{\partial^2 \eta}{\partial x \partial z}\)</span> . There’s disagreement about the type that researchers should “usually” care about. Most people—Bill Berry might be the only exception—would argue that <span class="math inline">\(\frac{\partial^2 \eta}{\partial x \partial z}\)</span> is the obvious default. Some might hold the extreme view that <span class="math inline">\(\frac{\partial^2 \eta}{\partial x \partial z}\)</span> is the only interaction effect worth hypothesizing about. Regardless, I don’t see any consensus that <span class="math inline">\(\frac{\partial^2 \pi}{\partial x \partial z}\)</span> is THE interaction effect.</p>
<p>Regardless, you should be aware of the two possibilities for defining and measuring interaction.</p>
<p>BDE define interaction in terms of the second derivative (or “cross partial derivative”) <span class="math inline">\(\frac{\partial^2 \pi}{\partial x \partial z}\)</span> or the analogous second difference. The second <em>derivative</em> is easier to write about (i.e., type), but the second difference is easier to compute.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="berry-demeritt-and-esarey-2010.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb325-2"><a href="berry-demeritt-and-esarey-2010.html#cb325-2" aria-hidden="true" tabindex="-1"></a>scobit <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">&quot;data/scobit.dta&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb325-3"><a href="berry-demeritt-and-esarey-2010.html#cb325-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(newvote <span class="sc">!=</span> <span class="sc">-</span><span class="dv">1</span>) </span>
<span id="cb325-4"><a href="berry-demeritt-and-esarey-2010.html#cb325-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-5"><a href="berry-demeritt-and-esarey-2010.html#cb325-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model (w&amp;r&#39;s specification in bde table 1 on p. 263)</span></span>
<span id="cb325-6"><a href="berry-demeritt-and-esarey-2010.html#cb325-6" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> newvote <span class="sc">~</span> <span class="fu">poly</span>(neweduc, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> closing <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> south <span class="sc">+</span> gov</span>
<span id="cb325-7"><a href="berry-demeritt-and-esarey-2010.html#cb325-7" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(f, <span class="at">data =</span> scobit, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>))</span>
<span id="cb325-8"><a href="berry-demeritt-and-esarey-2010.html#cb325-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-9"><a href="berry-demeritt-and-esarey-2010.html#cb325-9" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate beta_tildes using KTW&#39;s method</span></span>
<span id="cb325-10"><a href="berry-demeritt-and-esarey-2010.html#cb325-10" aria-hidden="true" tabindex="-1"></a>beta_tilde <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">2000</span>, <span class="at">mean =</span> <span class="fu">coef</span>(fit), <span class="at">sigma =</span> <span class="fu">vcov</span>(fit))</span>
<span id="cb325-11"><a href="berry-demeritt-and-esarey-2010.html#cb325-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-12"><a href="berry-demeritt-and-esarey-2010.html#cb325-12" aria-hidden="true" tabindex="-1"></a><span class="co"># four scenarios of the second difference; 10th to 90th percentile for both</span></span>
<span id="cb325-13"><a href="berry-demeritt-and-esarey-2010.html#cb325-13" aria-hidden="true" tabindex="-1"></a><span class="co"># note: 1st lo/hi refers to neweduc; 2nd refers to closing</span></span>
<span id="cb325-14"><a href="berry-demeritt-and-esarey-2010.html#cb325-14" aria-hidden="true" tabindex="-1"></a>s_lo_lo <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb325-15"><a href="berry-demeritt-and-esarey-2010.html#cb325-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb325-16"><a href="berry-demeritt-and-esarey-2010.html#cb325-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb325-17"><a href="berry-demeritt-and-esarey-2010.html#cb325-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>age),</span>
<span id="cb325-18"><a href="berry-demeritt-and-esarey-2010.html#cb325-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">south =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>south),</span>
<span id="cb325-19"><a href="berry-demeritt-and-esarey-2010.html#cb325-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">gov =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>gov)) </span>
<span id="cb325-20"><a href="berry-demeritt-and-esarey-2010.html#cb325-20" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb325-21"><a href="berry-demeritt-and-esarey-2010.html#cb325-21" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_lo_lo)</span>
<span id="cb325-22"><a href="berry-demeritt-and-esarey-2010.html#cb325-22" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_lo_lo)</span>
<span id="cb325-23"><a href="berry-demeritt-and-esarey-2010.html#cb325-23" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb325-24"><a href="berry-demeritt-and-esarey-2010.html#cb325-24" aria-hidden="true" tabindex="-1"></a>eta_hat <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">coef</span>(fit)           <span class="co"># ml estimate of linear predictor</span></span>
<span id="cb325-25"><a href="berry-demeritt-and-esarey-2010.html#cb325-25" aria-hidden="true" tabindex="-1"></a>pi_lo_lo_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb325-26"><a href="berry-demeritt-and-esarey-2010.html#cb325-26" aria-hidden="true" tabindex="-1"></a>pi_lo_lo_hat <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_hat)      <span class="co"># ml estimate of expected value</span></span>
<span id="cb325-27"><a href="berry-demeritt-and-esarey-2010.html#cb325-27" aria-hidden="true" tabindex="-1"></a><span class="co"># note: I only care to &quot;keep&quot; things with the _lo_lo tag, everything </span></span>
<span id="cb325-28"><a href="berry-demeritt-and-esarey-2010.html#cb325-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   else gets overwritten below.</span></span>
<span id="cb325-29"><a href="berry-demeritt-and-esarey-2010.html#cb325-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-30"><a href="berry-demeritt-and-esarey-2010.html#cb325-30" aria-hidden="true" tabindex="-1"></a><span class="co"># hi; lo</span></span>
<span id="cb325-31"><a href="berry-demeritt-and-esarey-2010.html#cb325-31" aria-hidden="true" tabindex="-1"></a>s_hi_lo <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb325-32"><a href="berry-demeritt-and-esarey-2010.html#cb325-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb325-33"><a href="berry-demeritt-and-esarey-2010.html#cb325-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb325-34"><a href="berry-demeritt-and-esarey-2010.html#cb325-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>age),</span>
<span id="cb325-35"><a href="berry-demeritt-and-esarey-2010.html#cb325-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">south =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>south),</span>
<span id="cb325-36"><a href="berry-demeritt-and-esarey-2010.html#cb325-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">gov =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>gov)) </span>
<span id="cb325-37"><a href="berry-demeritt-and-esarey-2010.html#cb325-37" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb325-38"><a href="berry-demeritt-and-esarey-2010.html#cb325-38" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_hi_lo)</span>
<span id="cb325-39"><a href="berry-demeritt-and-esarey-2010.html#cb325-39" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_hi_lo)</span>
<span id="cb325-40"><a href="berry-demeritt-and-esarey-2010.html#cb325-40" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb325-41"><a href="berry-demeritt-and-esarey-2010.html#cb325-41" aria-hidden="true" tabindex="-1"></a>eta_hat <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">coef</span>(fit)           <span class="co"># ml estimate of linear predictor</span></span>
<span id="cb325-42"><a href="berry-demeritt-and-esarey-2010.html#cb325-42" aria-hidden="true" tabindex="-1"></a>pi_hi_lo_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb325-43"><a href="berry-demeritt-and-esarey-2010.html#cb325-43" aria-hidden="true" tabindex="-1"></a>pi_hi_lo_hat <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_hat)      <span class="co"># ml estimate of expected value</span></span>
<span id="cb325-44"><a href="berry-demeritt-and-esarey-2010.html#cb325-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-45"><a href="berry-demeritt-and-esarey-2010.html#cb325-45" aria-hidden="true" tabindex="-1"></a><span class="co"># lo; hi</span></span>
<span id="cb325-46"><a href="berry-demeritt-and-esarey-2010.html#cb325-46" aria-hidden="true" tabindex="-1"></a>s_lo_hi <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb325-47"><a href="berry-demeritt-and-esarey-2010.html#cb325-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb325-48"><a href="berry-demeritt-and-esarey-2010.html#cb325-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb325-49"><a href="berry-demeritt-and-esarey-2010.html#cb325-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>age),</span>
<span id="cb325-50"><a href="berry-demeritt-and-esarey-2010.html#cb325-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">south =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>south),</span>
<span id="cb325-51"><a href="berry-demeritt-and-esarey-2010.html#cb325-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">gov =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>gov)) </span>
<span id="cb325-52"><a href="berry-demeritt-and-esarey-2010.html#cb325-52" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb325-53"><a href="berry-demeritt-and-esarey-2010.html#cb325-53" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_lo_hi)</span>
<span id="cb325-54"><a href="berry-demeritt-and-esarey-2010.html#cb325-54" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_lo_hi)</span>
<span id="cb325-55"><a href="berry-demeritt-and-esarey-2010.html#cb325-55" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb325-56"><a href="berry-demeritt-and-esarey-2010.html#cb325-56" aria-hidden="true" tabindex="-1"></a>eta_hat <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">coef</span>(fit)           <span class="co"># ml estimate of linear predictor</span></span>
<span id="cb325-57"><a href="berry-demeritt-and-esarey-2010.html#cb325-57" aria-hidden="true" tabindex="-1"></a>pi_lo_hi_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb325-58"><a href="berry-demeritt-and-esarey-2010.html#cb325-58" aria-hidden="true" tabindex="-1"></a>pi_lo_hi_hat <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_hat)      <span class="co"># ml estimate of expected value</span></span>
<span id="cb325-59"><a href="berry-demeritt-and-esarey-2010.html#cb325-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-60"><a href="berry-demeritt-and-esarey-2010.html#cb325-60" aria-hidden="true" tabindex="-1"></a><span class="co"># hi; hi</span></span>
<span id="cb325-61"><a href="berry-demeritt-and-esarey-2010.html#cb325-61" aria-hidden="true" tabindex="-1"></a>s_hi_hi <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb325-62"><a href="berry-demeritt-and-esarey-2010.html#cb325-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb325-63"><a href="berry-demeritt-and-esarey-2010.html#cb325-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb325-64"><a href="berry-demeritt-and-esarey-2010.html#cb325-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>age),</span>
<span id="cb325-65"><a href="berry-demeritt-and-esarey-2010.html#cb325-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">south =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>south),</span>
<span id="cb325-66"><a href="berry-demeritt-and-esarey-2010.html#cb325-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">gov =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>gov)) </span>
<span id="cb325-67"><a href="berry-demeritt-and-esarey-2010.html#cb325-67" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb325-68"><a href="berry-demeritt-and-esarey-2010.html#cb325-68" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_hi_hi)</span>
<span id="cb325-69"><a href="berry-demeritt-and-esarey-2010.html#cb325-69" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_hi_hi)</span>
<span id="cb325-70"><a href="berry-demeritt-and-esarey-2010.html#cb325-70" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb325-71"><a href="berry-demeritt-and-esarey-2010.html#cb325-71" aria-hidden="true" tabindex="-1"></a>eta_hat <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">coef</span>(fit)           <span class="co"># ml estimate of linear predictor</span></span>
<span id="cb325-72"><a href="berry-demeritt-and-esarey-2010.html#cb325-72" aria-hidden="true" tabindex="-1"></a>pi_hi_hi_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb325-73"><a href="berry-demeritt-and-esarey-2010.html#cb325-73" aria-hidden="true" tabindex="-1"></a>pi_hi_hi_hat <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_hat)      <span class="co"># ml estimate of expected value</span></span>
<span id="cb325-74"><a href="berry-demeritt-and-esarey-2010.html#cb325-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-75"><a href="berry-demeritt-and-esarey-2010.html#cb325-75" aria-hidden="true" tabindex="-1"></a><span class="co"># ml estimate</span></span>
<span id="cb325-76"><a href="berry-demeritt-and-esarey-2010.html#cb325-76" aria-hidden="true" tabindex="-1"></a>(pi_hi_hi_hat <span class="sc">-</span> pi_lo_hi_hat) <span class="sc">-</span>   <span class="co"># effect of education when closing is high</span></span>
<span id="cb325-77"><a href="berry-demeritt-and-esarey-2010.html#cb325-77" aria-hidden="true" tabindex="-1"></a>  (pi_hi_lo_hat <span class="sc">-</span> pi_lo_lo_hat)   <span class="co"># effect of education when closing is low</span></span></code></pre></div>
<pre><code>##         [,1]
## 1 0.00704756</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="berry-demeritt-and-esarey-2010.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note: this is a difference between differences or a &quot;second difference&quot;</span></span>
<span id="cb327-2"><a href="berry-demeritt-and-esarey-2010.html#cb327-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-3"><a href="berry-demeritt-and-esarey-2010.html#cb327-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ktw simulations of second difference</span></span>
<span id="cb327-4"><a href="berry-demeritt-and-esarey-2010.html#cb327-4" aria-hidden="true" tabindex="-1"></a>dd_tilde <span class="ot">&lt;-</span> (pi_hi_hi_tilde <span class="sc">-</span> pi_lo_hi_tilde) <span class="sc">-</span>   <span class="co"># effect of education when closing is high</span></span>
<span id="cb327-5"><a href="berry-demeritt-and-esarey-2010.html#cb327-5" aria-hidden="true" tabindex="-1"></a>  (pi_hi_lo_tilde <span class="sc">-</span> pi_lo_lo_tilde)               <span class="co"># effect of education when closing is low</span></span>
<span id="cb327-6"><a href="berry-demeritt-and-esarey-2010.html#cb327-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-7"><a href="berry-demeritt-and-esarey-2010.html#cb327-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 90% CI using ktw simulations</span></span>
<span id="cb327-8"><a href="berry-demeritt-and-esarey-2010.html#cb327-8" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(dd_tilde, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span></code></pre></div>
<pre><code>##          5%         95% 
## 0.006318230 0.007776232</code></pre>
<p>We can compare this to Nagler’s specification using the AIC and BIC. (BDE use a “likelihood ratio test” that we’ll talk about soon).</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="berry-demeritt-and-esarey-2010.html#cb329-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> newvote <span class="sc">~</span> <span class="fu">poly</span>(neweduc, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>)<span class="sc">*</span>closing <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> south <span class="sc">+</span> gov</span>
<span id="cb329-2"><a href="berry-demeritt-and-esarey-2010.html#cb329-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(f, <span class="at">data =</span> scobit, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>))</span>
<span id="cb329-3"><a href="berry-demeritt-and-esarey-2010.html#cb329-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-4"><a href="berry-demeritt-and-esarey-2010.html#cb329-4" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fit, fit1)</span></code></pre></div>
<pre><code>##      df      AIC
## fit   8 111652.1
## fit1 10 111650.6</code></pre>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="berry-demeritt-and-esarey-2010.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(fit, fit1)</span></code></pre></div>
<pre><code>##      df      BIC
## fit   8 111728.1
## fit1 10 111745.6</code></pre>
<p>The AIC <em>barely</em> prefers the model with the product terms. The BIC <em>strongly</em> prefers the model that <em>omits</em> the product terms.</p>
<p>If we wanted, we could compute the second difference from Nagler’s specification and compare it to Wolfinger and Rosenstone’s.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="berry-demeritt-and-esarey-2010.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate beta_tildes using KTW&#39;s method</span></span>
<span id="cb333-2"><a href="berry-demeritt-and-esarey-2010.html#cb333-2" aria-hidden="true" tabindex="-1"></a>beta_tilde <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">2000</span>, <span class="at">mean =</span> <span class="fu">coef</span>(fit1), <span class="at">sigma =</span> <span class="fu">vcov</span>(fit1))</span>
<span id="cb333-3"><a href="berry-demeritt-and-esarey-2010.html#cb333-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-4"><a href="berry-demeritt-and-esarey-2010.html#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="co"># four scenarios of the second difference; 10th to 90th percentile for both</span></span>
<span id="cb333-5"><a href="berry-demeritt-and-esarey-2010.html#cb333-5" aria-hidden="true" tabindex="-1"></a><span class="co"># note: 1st lo/hi refers to neweduc; 2nd refers to closing</span></span>
<span id="cb333-6"><a href="berry-demeritt-and-esarey-2010.html#cb333-6" aria-hidden="true" tabindex="-1"></a>s_lo_lo <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb333-7"><a href="berry-demeritt-and-esarey-2010.html#cb333-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb333-8"><a href="berry-demeritt-and-esarey-2010.html#cb333-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb333-9"><a href="berry-demeritt-and-esarey-2010.html#cb333-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>age),</span>
<span id="cb333-10"><a href="berry-demeritt-and-esarey-2010.html#cb333-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">south =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>south),</span>
<span id="cb333-11"><a href="berry-demeritt-and-esarey-2010.html#cb333-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">gov =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>gov)) </span>
<span id="cb333-12"><a href="berry-demeritt-and-esarey-2010.html#cb333-12" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb333-13"><a href="berry-demeritt-and-esarey-2010.html#cb333-13" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_lo_lo)</span>
<span id="cb333-14"><a href="berry-demeritt-and-esarey-2010.html#cb333-14" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_lo_lo)</span>
<span id="cb333-15"><a href="berry-demeritt-and-esarey-2010.html#cb333-15" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb333-16"><a href="berry-demeritt-and-esarey-2010.html#cb333-16" aria-hidden="true" tabindex="-1"></a>eta_hat <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">coef</span>(fit1)           <span class="co"># ml estimate of linear predictor</span></span>
<span id="cb333-17"><a href="berry-demeritt-and-esarey-2010.html#cb333-17" aria-hidden="true" tabindex="-1"></a>pi_lo_lo_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb333-18"><a href="berry-demeritt-and-esarey-2010.html#cb333-18" aria-hidden="true" tabindex="-1"></a>pi_lo_lo_hat <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_hat)      <span class="co"># ml estimate of expected value</span></span>
<span id="cb333-19"><a href="berry-demeritt-and-esarey-2010.html#cb333-19" aria-hidden="true" tabindex="-1"></a><span class="co"># note: I only care to &quot;keep&quot; things with the _lo_lo tag, everything </span></span>
<span id="cb333-20"><a href="berry-demeritt-and-esarey-2010.html#cb333-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   else gets overwritten below.</span></span>
<span id="cb333-21"><a href="berry-demeritt-and-esarey-2010.html#cb333-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-22"><a href="berry-demeritt-and-esarey-2010.html#cb333-22" aria-hidden="true" tabindex="-1"></a><span class="co"># hi; lo</span></span>
<span id="cb333-23"><a href="berry-demeritt-and-esarey-2010.html#cb333-23" aria-hidden="true" tabindex="-1"></a>s_hi_lo <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb333-24"><a href="berry-demeritt-and-esarey-2010.html#cb333-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb333-25"><a href="berry-demeritt-and-esarey-2010.html#cb333-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb333-26"><a href="berry-demeritt-and-esarey-2010.html#cb333-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>age),</span>
<span id="cb333-27"><a href="berry-demeritt-and-esarey-2010.html#cb333-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">south =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>south),</span>
<span id="cb333-28"><a href="berry-demeritt-and-esarey-2010.html#cb333-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">gov =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>gov)) </span>
<span id="cb333-29"><a href="berry-demeritt-and-esarey-2010.html#cb333-29" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb333-30"><a href="berry-demeritt-and-esarey-2010.html#cb333-30" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_hi_lo)</span>
<span id="cb333-31"><a href="berry-demeritt-and-esarey-2010.html#cb333-31" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_hi_lo)</span>
<span id="cb333-32"><a href="berry-demeritt-and-esarey-2010.html#cb333-32" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb333-33"><a href="berry-demeritt-and-esarey-2010.html#cb333-33" aria-hidden="true" tabindex="-1"></a>eta_hat <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">coef</span>(fit1)           <span class="co"># ml estimate of linear predictor</span></span>
<span id="cb333-34"><a href="berry-demeritt-and-esarey-2010.html#cb333-34" aria-hidden="true" tabindex="-1"></a>pi_hi_lo_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb333-35"><a href="berry-demeritt-and-esarey-2010.html#cb333-35" aria-hidden="true" tabindex="-1"></a>pi_hi_lo_hat <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_hat)      <span class="co"># ml estimate of expected value</span></span>
<span id="cb333-36"><a href="berry-demeritt-and-esarey-2010.html#cb333-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-37"><a href="berry-demeritt-and-esarey-2010.html#cb333-37" aria-hidden="true" tabindex="-1"></a><span class="co"># lo; hi</span></span>
<span id="cb333-38"><a href="berry-demeritt-and-esarey-2010.html#cb333-38" aria-hidden="true" tabindex="-1"></a>s_lo_hi <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb333-39"><a href="berry-demeritt-and-esarey-2010.html#cb333-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb333-40"><a href="berry-demeritt-and-esarey-2010.html#cb333-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb333-41"><a href="berry-demeritt-and-esarey-2010.html#cb333-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>age),</span>
<span id="cb333-42"><a href="berry-demeritt-and-esarey-2010.html#cb333-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">south =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>south),</span>
<span id="cb333-43"><a href="berry-demeritt-and-esarey-2010.html#cb333-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">gov =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>gov)) </span>
<span id="cb333-44"><a href="berry-demeritt-and-esarey-2010.html#cb333-44" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb333-45"><a href="berry-demeritt-and-esarey-2010.html#cb333-45" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_lo_hi)</span>
<span id="cb333-46"><a href="berry-demeritt-and-esarey-2010.html#cb333-46" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_lo_hi)</span>
<span id="cb333-47"><a href="berry-demeritt-and-esarey-2010.html#cb333-47" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb333-48"><a href="berry-demeritt-and-esarey-2010.html#cb333-48" aria-hidden="true" tabindex="-1"></a>eta_hat <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">coef</span>(fit1)           <span class="co"># ml estimate of linear predictor</span></span>
<span id="cb333-49"><a href="berry-demeritt-and-esarey-2010.html#cb333-49" aria-hidden="true" tabindex="-1"></a>pi_lo_hi_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb333-50"><a href="berry-demeritt-and-esarey-2010.html#cb333-50" aria-hidden="true" tabindex="-1"></a>pi_lo_hi_hat <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_hat)      <span class="co"># ml estimate of expected value</span></span>
<span id="cb333-51"><a href="berry-demeritt-and-esarey-2010.html#cb333-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-52"><a href="berry-demeritt-and-esarey-2010.html#cb333-52" aria-hidden="true" tabindex="-1"></a><span class="co"># hi; hi</span></span>
<span id="cb333-53"><a href="berry-demeritt-and-esarey-2010.html#cb333-53" aria-hidden="true" tabindex="-1"></a>s_hi_hi <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb333-54"><a href="berry-demeritt-and-esarey-2010.html#cb333-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">neweduc =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb333-55"><a href="berry-demeritt-and-esarey-2010.html#cb333-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">closing =</span> <span class="fu">quantile</span>(scobit<span class="sc">$</span>neweduc, <span class="at">probs =</span> <span class="fl">0.9</span>),</span>
<span id="cb333-56"><a href="berry-demeritt-and-esarey-2010.html#cb333-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>age),</span>
<span id="cb333-57"><a href="berry-demeritt-and-esarey-2010.html#cb333-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">south =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>south),</span>
<span id="cb333-58"><a href="berry-demeritt-and-esarey-2010.html#cb333-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">gov =</span> <span class="fu">median</span>(scobit<span class="sc">$</span>gov)) </span>
<span id="cb333-59"><a href="berry-demeritt-and-esarey-2010.html#cb333-59" aria-hidden="true" tabindex="-1"></a>f_s <span class="ot">&lt;-</span> <span class="fu">update</span>(f, <span class="cn">NULL</span> <span class="sc">~</span> .)           <span class="co"># remove lhs for use below</span></span>
<span id="cb333-60"><a href="berry-demeritt-and-esarey-2010.html#cb333-60" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(f_s, s_hi_hi)</span>
<span id="cb333-61"><a href="berry-demeritt-and-esarey-2010.html#cb333-61" aria-hidden="true" tabindex="-1"></a>X_s <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mf, s_hi_hi)</span>
<span id="cb333-62"><a href="berry-demeritt-and-esarey-2010.html#cb333-62" aria-hidden="true" tabindex="-1"></a>eta_tilde <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">t</span>(beta_tilde)     <span class="co"># simulations of linear predictor</span></span>
<span id="cb333-63"><a href="berry-demeritt-and-esarey-2010.html#cb333-63" aria-hidden="true" tabindex="-1"></a>eta_hat <span class="ot">&lt;-</span> X_s<span class="sc">%*%</span><span class="fu">coef</span>(fit1)           <span class="co"># ml estimate of linear predictor</span></span>
<span id="cb333-64"><a href="berry-demeritt-and-esarey-2010.html#cb333-64" aria-hidden="true" tabindex="-1"></a>pi_hi_hi_tilde <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_tilde)  <span class="co"># simulations of expected value </span></span>
<span id="cb333-65"><a href="berry-demeritt-and-esarey-2010.html#cb333-65" aria-hidden="true" tabindex="-1"></a>pi_hi_hi_hat <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(eta_hat)      <span class="co"># ml estimate of expected value</span></span>
<span id="cb333-66"><a href="berry-demeritt-and-esarey-2010.html#cb333-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-67"><a href="berry-demeritt-and-esarey-2010.html#cb333-67" aria-hidden="true" tabindex="-1"></a><span class="co"># ml estimate</span></span>
<span id="cb333-68"><a href="berry-demeritt-and-esarey-2010.html#cb333-68" aria-hidden="true" tabindex="-1"></a>(pi_hi_hi_hat <span class="sc">-</span> pi_lo_hi_hat) <span class="sc">-</span>   <span class="co"># effect of education when closing is high</span></span>
<span id="cb333-69"><a href="berry-demeritt-and-esarey-2010.html#cb333-69" aria-hidden="true" tabindex="-1"></a>  (pi_hi_lo_hat <span class="sc">-</span> pi_lo_lo_hat)   <span class="co"># effect of education when closing is low</span></span></code></pre></div>
<pre><code>##          [,1]
## 1 0.004674478</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="berry-demeritt-and-esarey-2010.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note: this is a difference between differences or a &quot;second difference&quot;</span></span>
<span id="cb335-2"><a href="berry-demeritt-and-esarey-2010.html#cb335-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-3"><a href="berry-demeritt-and-esarey-2010.html#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ktw simulations of second difference</span></span>
<span id="cb335-4"><a href="berry-demeritt-and-esarey-2010.html#cb335-4" aria-hidden="true" tabindex="-1"></a>dd_tilde <span class="ot">&lt;-</span> (pi_hi_hi_tilde <span class="sc">-</span> pi_lo_hi_tilde) <span class="sc">-</span>   <span class="co"># effect of education when closing is high</span></span>
<span id="cb335-5"><a href="berry-demeritt-and-esarey-2010.html#cb335-5" aria-hidden="true" tabindex="-1"></a>  (pi_hi_lo_tilde <span class="sc">-</span> pi_lo_lo_tilde)               <span class="co"># effect of education when closing is low</span></span>
<span id="cb335-6"><a href="berry-demeritt-and-esarey-2010.html#cb335-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-7"><a href="berry-demeritt-and-esarey-2010.html#cb335-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 90% CI using ktw simulations</span></span>
<span id="cb335-8"><a href="berry-demeritt-and-esarey-2010.html#cb335-8" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(dd_tilde, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span></code></pre></div>
<pre><code>##          5%         95% 
## 0.002202094 0.007174123</code></pre>
<p>Contrary to what you might expect, the model <em>with</em> the product term exhibits <em>less</em> interaction than the model without product terms (this is BDE’s basic point).</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="berry-golder-and-milton-2012.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rainey-2016.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["adv-methods-notes.pdf", "adv-methods-notes.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
